#!/bin/sh
#SBATCH --job-name=evaluate_ripple
#SBATCH --array=0-0
#SBATCH --partition=shared
#SBATCH --mem=80G
#SBATCH -t 0-72:00
#SBATCH -c 1
#SBATCH --output=/n/home04/rrinberg/catered_out/ripple_bench/cyber-ripple_%A__%a.out
#SBATCH --mail-user=royrinberg@gmail.com  
#SBATCH --mail-type=ALL
#SBATCH --account vadhan_lab



### vadhan_lab

module load python/3.10.12-fasrc01
module load intelpython/3.9.16-fasrc01
#module load cuda cudnn
mamba activate unlearning_3.10

set -x 

## logging
CODE_DIR=/n/home04/rrinberg/code/data_to_concept_unlearning
BASE=/n/home04/rrinberg/code/data_to_concept_unlearning
pushd $BASE

export WIKI_FAISS_PATH=/n/home04/rrinberg/data_dir/wikipedia/hugging_face/faiss_index__top_1000000__2025-07-12

python3 $BASE/scripts/build_ripple_bench_from_wmdp.py \
    --wmdp-path $BASE/data/wmdp/wmdp-cyber.json \
     --k-neighbors 1000 \
    --neighbor-sample-step 3 \
    --questions-per-topic 5 \
    --output-dir $BASE/data/ripple_bench_2025-09-05-cyber \
    --use-local-wikipedia \
    --wiki-json-path /n/home04/rrinberg/data_dir/wikipedia/json \
    --max-workers 4 \
    --use-cache \
    --faiss-path /n/home04/rrinberg/data_dir/wikipedia/hugging_face/faiss_index__top_1000000__2025-07-12


#--use-timestamp \
# 
#--llm-provider anthropic \

