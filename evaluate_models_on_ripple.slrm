#!/bin/sh
#SBATCH --job-name=evaluate_ripple
#SBATCH --array=0-65%6
#SBATCH --partition=kempner_h100
#SBATCH --mem=80G
#SBATCH --gres=gpu:1
#SBATCH -t 0-32:00
#SBATCH -c 1
#SBATCH --output=/n/home04/rrinberg/catered_out/ripple_bench/evaluate-ripple-%A__%a.out
#SBATCH --mail-user=royrinberg@gmail.com  
#SBATCH --mail-type=ALL
#SBATCH --account kempner_sham_lab

### vadhan_lab

set -x 

module load python/3.10.12-fasrc01
module load intelpython/3.9.16-fasrc01
#module load cuda cudnn
mamba activate unlearning_3.10


## logging
CODE_DIR=/n/home04/rrinberg/code/data_to_concept_unlearning

pushd $CODE_DIR

## Run the experiment


#python scripts/evaluate_multiple_models.py \
#    data/ripple_bench_2025-09-12-bio/ripple_bench_dataset.json \
#    --output-dir results/all_models__duplicated__BIO_9_12/ \#
#    --model-index $SLURM_ARRAY_TASK_ID \
#    --all-checkpoints --discover-cache



python scripts/evaluate_multiple_models.py \
    data/ripple_bench_2025-09-12-chem/ripple_bench_dataset.json \
    --output-dir results/all_models__duplicated__CHEM_9_17/ \
    --model-index $SLURM_ARRAY_TASK_ID \
    --all-checkpoints --discover-cache
